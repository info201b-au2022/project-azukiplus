---
title: "blackjack :game_die:"
author: "Ryan William Breuer, Vincent Li, Ashley Mochizuki"
date: "11/14/2022"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## What is this file for?

* This file will eventually become your project report for **P02: Exploratory Data Analysis**. Specifically, you will write rmarkdown to report your exploratory data analysis.

* Please see Canvas for more details.

## ACCESSING THE /source DIRECTORY
### Example 1: Source some code and run a function
```{r}
# Example 1: Note relative path, which can be read: Up one
# directory(..), down into source (/source), and
# then "source" an R file (data_access.R)
source("../source/data_access.R")
data_access_test()
```

### Example 2: Initialize a variable and then use it
```{r}
# Example 1: This function was "sourced" above
msg <- data_access_test(" Morgan!")
```

> `r msg` Hope you have a good day!!

## ABOUT THIS FILE:

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Summary Tables

```{r kable_example, echo = FALSE}
# load packages
library(foreign)
library("dplyr")
library("tidyverse")
library("knitr")

# get data file and store as a data frame
data <- read.spss("https://github.com/info201b-au2022/project-azukiplus/blob/main/data/2018_2019_ANP_online.sav?raw=true", to.data.frame = TRUE)

# store the total number of participants
participants <- nrow(data)

# separate columns in to b and F since there are two different sets of survey.
baseline_surveys <- data %>%
  select(starts_with("b"))

follow_up_surveys <- data %>%
  select(starts_with("F"))

follow_completion <- follow_up_surveys %>%
  filter(!is.na(F_followUpcomplete)) %>%
  summarise(total = participants, 
            completed = length(F_followUpcomplete), 
            missing = participants - completed, 
            completion_rate = round(completed / participants, digit = 4))

first_drug_usage <- baseline_surveys %>%
  group_by(b_c5a) %>%
  count(b_c5a) %>%
  mutate(percentage_base = round(n / participants * 100, digit = 2)) %>% 
  rename("Drug status" = "b_c5a",
         "number_base" = "n")

second_drug_usage <- follow_up_surveys %>%
  filter(!is.na(F_c5a)) %>%
  group_by(F_c5a) %>%
  count(F_c5a) %>%
  mutate(percentage_follow = round(n / follow_completion$completed * 100, digit = 2), 
         whole_percentage = round(n / participants * 100, digit = 2)) %>% 
  rename("Drug status" = "F_c5a",
         "number_follow" = "n")

overall_drug_status <- left_join(first_drug_usage, second_drug_usage, by = "Drug status")

kable(overall_drug_status)
```


```{r kable_example, echo = FALSE}
first_lottery_frequency <- baseline_surveys %>%
  group_by(b_g1a) %>%
  count(b_g1a) %>%
  mutate(percentage_base = round(n / participants * 100, digit = 2)) %>% 
  rename("lottery status" = "b_g1a",
         "number_base" = "n")

second_lottery_frequency <- follow_up_surveys %>%
  filter(!is.na(F_g1a)) %>%
  group_by(F_g1a) %>%
  count(F_g1a) %>%
  mutate(percentage_follow = round(n / follow_completion$completed * 100, digit = 2), 
         whole_percentage = round(n / participants * 100, digit = 2)) %>% 
  rename("lottery status" = "F_g1a",
         "number_follow" = "n")

overall_lottery_frequency <- left_join(first_lottery_frequency, second_lottery_frequency, by = "lottery status")

kable(overall_lottery_frequency)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
